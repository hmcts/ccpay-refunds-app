configurations.all {
  resolutionStrategy {
    eachDependency { DependencyResolveDetails details ->
      /* JAR upgrades with latest versions for CVE fixes*/

      /*
          CVE-2020-25638
      * */
      if (details.requested.name == 'hibernate-core') {
        details.useVersion '5.4.25.Final'
      }

      /*
           CVE-2020-26945
      * */
      if (details.requested.name == 'mybatis') {
        details.useVersion '3.5.7'
      }

      /*
           CVE-2012-6708, CVE-2019-11358, CVE-2020-11022
      * */
      if (details.requested.name == 'testng') {
        details.useVersion '7.4.0'
      }

      /*
          CVE-2021-27568
      * */
      if (details.requested.name == 'json-smart') {
        details.useVersion '2.4.7'
      }

      /*
        * CVE-2021-33037
      * */
      if (details.requested.name == 'tomcat-embed-core') {
        details.useVersion '9.0.50'
      }
      if (details.requested.name == 'tomcat-embed-websocket') {
        details.useVersion '9.0.50'
      }

      /*
        * CVE-2021-33037
        * */
      if (details.requested.name == 'tomcat-embed-core') {
        details.useVersion '9.0.54'
      }
      if (details.requested.name == 'tomcat-embed-websocket') {
        details.useVersion '9.0.54'
      }

      /*
        * CVE-2019-10086
        * */
      if (details.requested.name == 'commons-beanutils') {
        details.useVersion '1.9.4'
      }

      /*
        * CVE-2021-22118
      * */
      if (details.requested.name == 'spring-core') {
        details.useVersion '5.3.15'
      }


      /*
       *
       * CVE-2021-28170
     **/
      if (details.requested.name == 'jakarta.el') {
        details.useVersion '4.0.1'
      }

      /*
        * CVE-2021-22119
      * */
      if (details.requested.name == 'spring-security-core') {
        details.useVersion '5.5.1'
      }

      /*
        * CVE-2021-22119, CVE-2021-42550
      * */
      if (details.requested.name == 'logback-classic' || details.requested.name == 'logback-core') {
        details.useVersion '1.2.10'
      }

      /*
        * CVE-2021-43797, CVE-2021-37136, CVE-2021-37137, CVE-2021-21295, CVE-2021-21409
      * */
      if (details.requested.name == 'netty-buffer' || details.requested.name == 'netty-codec' || details.requested.name == 'netty-codec-dns'
              || details.requested.name == 'netty-codec-http' || details.requested.name == 'netty-codec-http2'
              || details.requested.name == 'netty-codec-socks' || details.requested.name == 'netty-common'
              || details.requested.name == 'netty-handler' || details.requested.name == 'netty-handler-proxy'
              || details.requested.name == 'netty-resolver' || details.requested.name == 'netty-resolver-dns'
              || details.requested.name == 'netty-resolver-dns-native-macos' || details.requested.name == 'netty-transport'
              || details.requested.name == 'netty-transport-native-epoll' || details.requested.name == 'netty-transport-native-unix-common') {
        details.useVersion '4.1.73.Final'
      }

      /* CVE fix with latest version ends here */
    }
  }
}
